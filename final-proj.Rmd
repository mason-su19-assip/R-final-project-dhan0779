---
title: "NASA Dataset Final Project"
author: "David Han"
date: "6/28/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(highcharter))
suppressPackageStartupMessages(library(leaflet))
suppressPackageStartupMessages(library(corrplot))
suppressPackageStartupMessages(library(modelr))
suppressPackageStartupMessages(library(broom))
suppressPackageStartupMessages(library("ggpubr"))
library(plotly)
dfnasa <- as.data.frame(nasa)
year1 = slice(dfnasa,1,577,1153,1729,2305,2881,3457,4033,4609,5185,5761,6337)
year2 = slice(dfnasa,6913,7489,8065,8641,9217,9793,10369,10945,11521,12097,12673,13249)
year3 = slice(dfnasa,13825,14401,14977,15553,16129,16705,17281,17857,18433,19009,19585,20161)
year4 = slice(dfnasa,20737,21313,21889,22465,23041,23617,24193,24769,25345,25921,26497,27073)
year5 = slice(dfnasa,27649,28225,28801,29377,29953,30529,31105,31681,32257,32833,33409,33985)
year6 = slice(dfnasa,34561,35137,35713,36289,36865,37441,38017,38593,39169,39745,40321,40897)
combine = rbind(year1,year2,year3,year4,year5,year6)
combine <- as.data.frame(combine)
```
##NASA Spatio-temporal Data

The data are geographic and atospheric measures on a very coarse 24 by 24 grid covering Central America. The data was obtained from the NASA Langley Research Center - Atmospheric Science Data Center.

##Storage

The data was stored in a data cube tbl from the dplyr package (tbl_cube). This type of data storage uses two arguments: dimensions and measures. The dimensions is a named list of vectors while measures is a named list of arrays.

Dimensions - latitude, longitude, month, and year.

Measures - Cloud coverage, ozone, surface temperature, temperature, and pressure.

```{r}
summary(nasa)
```

## Variables


####Latitude/Longitude
These two terms are used to specify precise locations of features on the surface of the Earth. In our case, 576 points were picked evenly spread on a 24 by 24 grid.

####Month/Year
Each measure of data were measured every month for 6 years on all 576 locations.

####Cloud Coverage
Cloud coverage refers to the fraction of the sky obscured by clouds from a particular location. The higher the number, the greatter the coverage. This piece of data was measured at three different levels: low, medium, and high per location.

####Ozone
Ozone protects us from the sun's UV rays and is measured in Dobson units (DU). Each Dobson unit refers to 0.01 millimeters of thickness. For reference, the ozone in the atmosphere is around 300 Dobsons.

####Pressure
Pressure refers to the atmospheric pressure measured in millibars. For referece, the average pressure at sea level is around 1013 millibars.

####Temperature
Temperature is the degree or intensity of heat in the atmosphere.The temperature is measured in Kelvin rather than Celsius or Fahrenheit.

####Surface Temperature
Surface temperature is the temperature measured on the surface of Earth. This is also measured in Kelvin.

##Overview

```{r}
dfnasa <- as.data.frame(nasa)
year1 = slice(dfnasa,1,577,1153,1729,2305,2881,3457,4033,4609,5185,5761,6337)
```
Converted the nasa data into a data frame. Using slice(), I split the data into each year from 1995 to 2000.


Using the highcharter package, I created multiple line graphs to form basic relationships for each year.

####Cloud Coverage
```{r}
highchart() %>%
  hc_xAxis(categories = year1$month) %>% 
  hc_add_series(name = "High Cloud", data = year1$cloudhigh) %>% 
  hc_add_series(name = "Low Cloud", data = year1$cloudlow) %>%
  hc_add_series(name = "Medium Cloud", data = year1$cloudmid) %>%
  hc_add_theme(hc_theme_538())
```
Compares all of the cloud coverage (low, medium, high) into a line graph.

####Temperatures and Ozone
```{r}
highchart() %>%
  hc_xAxis(categories = year1$month) %>% 
  hc_add_series(name = "Temperature", data = year1$temperature) %>% 
  hc_add_series(name = "Surface Temperature", data = year1$surftemp) %>%
  hc_add_series(name = "Ozone", data = year1$ozone) %>%
  hc_add_theme(hc_theme_economist())
```
Compares the temperature, surface temperature and ozone layer using a line graph.

####Air Pressure
```{r}
highchart() %>%
  hc_xAxis(categories = year1$month) %>%
  hc_add_series(name = "Pressure", data = year1$pressure) %>%
  hc_add_theme(hc_theme_ffx())
```
Used a line graph to show any general trends of the pressure data.


##Using Latitudes and Longitudes

####Temperature Distribution

```{r}
dflat = dfnasa$lat[1:576]
dflong = dfnasa$long[1:576]

qpal <- colorFactor(c("blue","royalblue","lightskyblue", "yellow","orange","red"), 
                    domain = dfnasa$temperature[1:576])

leaflet(slice(dfnasa,1:576)) %>%
  addTiles() %>%
  setView(lng = -90, lat =  10, zoom = 3) %>%
  addCircleMarkers(lat = dflat, lng = dflong,color = ~qpal(temperature),
                   stroke = FALSE, fillOpacity= 0.3,
                   popup = paste("Temperature:", dfnasa$temperature))
```
Using the leaflet package to create a map, I marked the temperatures of each region in the 24 by 24 grid. The red shows hotter temperatures while the blue shows cooler temperatures.

####Air Pressure Distribution

```{r}
dflat = dfnasa$lat[1:576]
dflong = dfnasa$long[1:576]

qpal <- colorFactor(c("blue","yellow2","orange","firebrick1"), 
                    domain = dfnasa$pressure[1:576])

leaflet(slice(dfnasa,1:576)) %>%
  addTiles() %>%
  setView(lng = -90, lat =  10, zoom = 3) %>%
  addCircleMarkers(lat = dflat, lng = dflong,color = ~qpal(pressure),
                   stroke = FALSE, fillOpacity= 0.5,
                   popup = paste("Pressure:",dfnasa$pressure))
```
This map shows the distribution of air pressure across the 24 by 24 grid.

##Pearson's Correlation

The purpose of the Pearson's correlation was to make clearer relationships with the variables. As shown below, the positive, blue numbers show a positive correlation while the negative, red numbers show a negative correlation. The closer the number is to -1 or 1, the stronger the correlation.

```{r}
selected_var <- combine %>%
  select(cloudhigh,cloudmid,cloudlow,ozone,pressure,temperature,surftemp)


corr_nasa <- cor(selected_var)
corrplot(corr_nasa,method = "number")
```
<br><br>
Correlation with selected variables (cloud coverage, ozone, pressure, temperatures).
<br><br>
As a result of the correlation table:
Low cloud coverage, temperature, and surface temperature were positively correlated while high cloud coverage, middle cloud coverage, and ozone were positively correlated. AIr pressure did not seem to correlate with any of the other variables.


